<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>Splitter Ratio Based</title>
  <style>
    html, body {
      margin: 0;
      height: 100%;
    }

    .container {
      display: flex;
      height: 100vh;
      max-width: 1200px;
      margin: 0 auto;
      border: 1px solid #ccc;
    }

    .panel {
      flex-grow: 0;
      flex-shrink: 0;
      flex-basis: 33.33%;
      min-width: 10%;
      padding: 10px;
      background-color: #f0f0f0;
      box-sizing: border-box;
      overflow: auto;
    }

    .splitter {
      width: 5px;
      background-color: #888;
      cursor: ew-resize;
      flex-shrink: 0;
      user-select: none;
    }
  </style>
</head>
<body>

  <div class="container" id="container">
    <div class="panel">パネル1</div>
    <div class="splitter"></div>
    <div class="panel">パネル2</div>
    <div class="splitter"></div>
    <div class="panel">パネル3</div>
  </div>

  <script>
    const container = document.getElementById('container');
    const splitters = container.querySelectorAll('.splitter');

    splitters.forEach((splitter, i) => {
      let isDragging = false;
      let startX = 0;
      let containerWidth = 0;
      let prevPanel, nextPanel;
      let prevBasis, nextBasis;

      splitter.addEventListener('mousedown', (e) => {
        isDragging = true;
        startX = e.clientX;
        containerWidth = container.getBoundingClientRect().width;

        prevPanel = splitter.previousElementSibling;
        nextPanel = splitter.nextElementSibling;

        prevBasis = parseFloat(getComputedStyle(prevPanel).flexBasis);
        nextBasis = parseFloat(getComputedStyle(nextPanel).flexBasis);

        document.body.style.cursor = 'ew-resize';
        document.body.style.userSelect = 'none';
      });

      const onMouseMove = (e) => {
        if (!isDragging) return;

        const deltaX = e.clientX - startX;
        const deltaPercent = (deltaX / containerWidth) * 100;

        let newPrev = prevBasis + deltaPercent;
        let newNext = nextBasis - deltaPercent;

        // 制限：10%〜90% に抑える（変に潰れないように）
        if (newPrev < 10 || newNext < 10) return;

        prevPanel.style.flexBasis = `${newPrev}%`;
        nextPanel.style.flexBasis = `${newNext}%`;
      };

      const onMouseUp = () => {
        isDragging = false;
        document.body.style.cursor = 'default';
        document.body.style.userSelect = 'auto';
      };

      document.addEventListener('mousemove', onMouseMove);
      document.addEventListener('mouseup', onMouseUp);
    });
  </script>

</body>
</html>
